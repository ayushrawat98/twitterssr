import{$ as g,A as F,Aa as K,B as r,C as L,D as _,E as S,Ea as Q,G as R,I as k,Ja as W,K as p,M as b,Ma as M,N,Na as X,O as $,P as l,Q as a,R as d,S as v,T as C,U as s,Z as c,_ as x,a as w,c as V,ga as I,ia as B,j as E,ka as H,m as j,p as m,pa as Y,q as u,qa as Z,t as P,ta as q,u as h,v as z,va as G,wa as J,x as A,z as y}from"./chunk-3DPVQO5R.js";var U=class i{constructor(t){this.http=t}postSuccessSubject=new V;baseUrl=M.baseUrl;getAllPosts(t,e){return this.http.get(this.baseUrl+"/api/post?page="+e,{withCredentials:!0})}getAllUserPosts(t,e){return this.http.get(`${this.baseUrl}/api/post/${t}/posts`,{withCredentials:!0})}getPostById(t,e,n){return this.http.get(`${this.baseUrl}/api/post/${e}`,{withCredentials:!0})}addNewPost(t){let e=new FormData;return e.append("content",t.content),e.append("parentpostid",t.parentpostid?.toString()??""),t.file&&e.append("file",t.file),this.http.post(this.baseUrl+"/api/post",e,{withCredentials:!0})}likePost(t,e,n){return this.http.post(this.baseUrl+"/api/post/like",{userid:t,postid:e,receiverid:n},{withCredentials:!0})}Repost(t,e,n){return this.http.post(this.baseUrl+"/api/post/repost",{userid:t,postid:e,receiverid:n},{withCredentials:!0})}Bookmark(t,e,n){return this.http.post(this.baseUrl+"/api/post/bookmark",{userid:t,postid:e,receiverid:n},{withCredentials:!0})}static \u0275fac=function(e){return new(e||i)(j(K))};static \u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"})};var ne=(i,t)=>({"bi-heart-fill red":i,"bi-heart":t}),oe=(i,t)=>({green:i,"":t}),re=(i,t)=>({"bi-bookmark-fill blue":i,"bi-bookmark":t});function se(i,t){i&1&&d(0,"div",1)}function ae(i,t){if(i&1){let e=v();l(0,"button",8),C("click",function(o){m(e);let f=s(3);return f.showIframe=!0,u(o.stopPropagation())}),c(1,"Embed Video"),a()}}function pe(i,t){if(i&1&&d(0,"iframe",12),i&2){let e=s(3);p("src",e.youtubeUrl(),F)}}function le(i,t){if(i&1&&k(0,ae,2,0,"button")(1,pe,1,1,"iframe",12),i&2){let e=s(2);b(e.showIframe?1:0)}}function ce(i,t){if(i&1&&d(0,"video",13),i&2){let e=s(3);p("src",e.baseUrl+"/"+e.post().media,y)}}function de(i,t){if(i&1&&d(0,"img",14),i&2){let e=s(3);p("src",e.baseUrl+"/"+e.post().media,y)}}function me(i,t){if(i&1&&k(0,ce,1,1,"video",13)(1,de,1,1,"img",14),i&2){let e=s(2);b(e.post().mediatype=="video/mp4"||e.post().mediatype=="video/webm"?0:1)}}function ue(i,t){if(i&1){let e=v();l(0,"article")(1,"aside"),d(2,"img",0),k(3,se,1,0,"div",1),a(),l(4,"div",2)(5,"header")(6,"span",3),c(7),a(),c(8," \xA0 "),l(9,"span",4),c(10),a(),c(11," \xA0 "),l(12,"span",5),c(13),B(14,"date"),a()(),l(15,"section",3)(16,"p"),c(17),a(),k(18,le,2,1)(19,me,2,1),a(),l(20,"footer",6)(21,"div",3),d(22,"i",7),c(23),a(),l(24,"div",8),C("click",function(){m(e);let o=s();return u(o.likeClicked.emit(o.post().id))}),d(25,"i",9),c(26),a(),l(27,"div",8),C("click",function(){m(e);let o=s();return u(o.repostClicked.emit(o.post().id))}),d(28,"i",10),c(29),a(),l(30,"div"),d(31,"i",11),c(32),a(),l(33,"div",8),C("click",function(){m(e);let o=s();return u(o.bookmarkClicked.emit(o.post().id))}),d(34,"i",9),c(35),a()()()()}if(i&2){let e=s();r(2),p("src",e.post().User.profilepicture?e.baseUrl+"/"+e.post().User.profilepicture:"default.png",y)("routerLink","/"+e.post().User.username),r(),b(e.showSeperator()?3:-1),r(3),p("routerLink","/"+e.post().User.username),r(),x(e.post().User.displayname),r(2),p("routerLink","/"+e.post().User.username),r(),x("@"+e.post().User.username),r(3),x(H(14,21,e.post().createdAt,"d/M/YY, h:mm a")),r(2),p("routerLink","/"+e.post().User.username+"/post/"+e.post().id),r(2),x(e.post().content),r(),b(e.youtubeUrl()?18:-1),r(),b(e.post().media?19:-1),r(2),p("routerLink","/"+e.post().User.username+"/post/"+e.post().id),r(2),g(" ",e.post().commentcount," "),r(2),p("ngClass",I(24,ne,e.post().liked,!e.post().liked)),r(),g(" ",e.post().likecount," "),r(2),p("ngClass",I(27,oe,e.post().reposted,!e.post().reposted)),r(),g(" ",e.post().repostcount," "),r(3),g(" ",e.post().views," "),r(2),p("ngClass",I(30,re,e.post().bookmarked,!e.post().bookmarked)),r(),g(" ",e.post().bookmarkcount," ")}}var O=class i{constructor(t){this.sanitizer=t}post=h.required();showSeperator=h();youtubeUrl=Y(()=>{if(this.post()){let t=/(?:https?:\/\/)?(?:www\.)?youtu(?:\.be\/|be.com\/\S*(?:watch|embed)(?:(?:(?=\/[-a-zA-Z0-9_]{11,}(?!\S))\/)|(?:\S*v=|v\/)))([-a-zA-Z0-9_]{11,})/,e=this.post().content.match(t);return e&&e[1]?this.sanitizer.bypassSecurityTrustResourceUrl(`https://www.youtube.com/embed/${e[1]}`):""}return""});baseUrl=M.baseUrl;showIframe=!1;likeClicked=P();repostClicked=P();bookmarkClicked=P();static \u0275fac=function(e){return new(e||i)(_(Q))};static \u0275cmp=S({type:i,selectors:[["app-post"]],inputs:{post:[1,"post"],showSeperator:[1,"showSeperator"]},outputs:{likeClicked:"likeClicked",repostClicked:"repostClicked",bookmarkClicked:"bookmarkClicked"},decls:1,vars:1,consts:[["alt","profile pic thumbnail",1,"profile-thumbnail",3,"src","routerLink"],[2,"width","2px","background-color","gray","flex-grow","1"],[1,"post"],[3,"routerLink"],[1,"username",3,"routerLink"],[1,"date"],[1,"action"],[1,"bi","bi-chat","pointer"],[3,"click"],[1,"bi","pointer",3,"ngClass"],[1,"bi","bi-repeat","pointer",3,"ngClass"],[1,"bi","bi-bar-chart"],["frameborder","0","allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture","loading","lazy","allowfullscreen","",2,"width","98%","height","280px",3,"src"],["preload","none","controls","",3,"src"],["loading","lazy",3,"src"]],template:function(e,n){e&1&&k(0,ue,36,33,"article"),e&2&&b(n.post()?0:-1)},dependencies:[W,G,q],styles:["article[_ngcontent-%COMP%]{border:1px solid rgb(46,64,82);border-radius:8px;padding:8px;margin:8px 0;display:flex;gap:8px}.post[_ngcontent-%COMP%]{flex:1;min-width:0}span[_ngcontent-%COMP%]{font-weight:500}span.date[_ngcontent-%COMP%]{font-weight:100;font-size:12px}span.username[_ngcontent-%COMP%]{font-weight:100}p[_ngcontent-%COMP%]{color:#fff;word-wrap:break-word;white-space:pre-wrap}.action[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin:24px 0 0;font-style:normal}.action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-style:normal;font-weight:100!important;margin-right:4px}section[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], section[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{display:block;max-width:100%;margin:auto;border-radius:8px}.greenn[_ngcontent-%COMP%]{fill:green}.profile-thumbnail[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;object-fit:cover}aside[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}"],changeDetection:0})};var D=class i{constructor(t,e,n){this.el=t;this.renderer=e;this.platformId=n}observer;ngAfterViewInit(){J(this.platformId)&&(this.observer=new IntersectionObserver(([t])=>{t.isIntersecting&&(this.renderer.addClass(this.el.nativeElement,"visible"),this.observer?.disconnect())},{threshold:.1}),this.observer.observe(this.el.nativeElement))}ngOnDestroy(){this.observer?.disconnect()}static \u0275fac=function(e){return new(e||i)(_(z),_(L),_(A))};static \u0275dir=R({type:i,selectors:[["","appIntersect",""]]})};var _e=(i,t)=>t.id;function fe(i,t){if(i&1){let e=v();l(0,"app-post",1),C("likeClicked",function(o){m(e);let f=s();return u(f.likeClicked(o))})("repostClicked",function(o){m(e);let f=s();return u(f.repostClicked(o))})("bookmarkClicked",function(o){m(e);let f=s();return u(f.bookmarkClicked(o))}),a()}if(i&2){let e=t.$implicit,n=s();p("post",e)("showSeperator",n.showSeperator())}}var ee=class i{constructor(t,e){this._authService=t;this._postService=e;Z(()=>{this.listMutable=this.list()})}list=h([]);listMutable;showSeperator=h();likeClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.likePost(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.liked=!e.liked,e.liked?e.likecount++:e.likecount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?w({},e):o)}})}repostClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.Repost(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.reposted=!e.reposted,e.reposted?e.repostcount++:e.repostcount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?w({},e):o)}})}bookmarkClicked(t){if(!this._authService.userdata()){alert("Login to continue");return}let e=this.listMutable.filter(n=>n.id==t)[0];this._postService.Bookmark(this._authService.userdata()?.id,e.id,e.UserId).subscribe({next:n=>{e.bookmarked=!e.bookmarked,e.bookmarked?e.bookmarkcount++:e.bookmarkcount--,this.listMutable=this.listMutable.map(o=>o.id==e.id?w({},e):o)}})}static \u0275fac=function(e){return new(e||i)(_(X),_(U))};static \u0275cmp=S({type:i,selectors:[["app-postlist"]],inputs:{list:[1,"list"],showSeperator:[1,"showSeperator"]},decls:2,vars:0,consts:[["appIntersect","",3,"post","showSeperator"],["appIntersect","",3,"likeClicked","repostClicked","bookmarkClicked","post","showSeperator"]],template:function(e,n){e&1&&N(0,fe,1,2,"app-post",0,_e),e&2&&$(n.listMutable)},dependencies:[O,D],styles:[".seperator[_ngcontent-%COMP%]{display:flex;justify-content:center}"]})};export{U as a,ee as b};
