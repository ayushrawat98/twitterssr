import './polyfills.server.mjs';
import{a as v}from"./chunk-N2OD3ABK.mjs";import{a as B,b as j}from"./chunk-5LZR7KMR.mjs";import"./chunk-TPPXJY7G.mjs";import{b as A}from"./chunk-NUHSH56V.mjs";import{$ as r,M as s,N as a,S as u,U as p,W as d,Z as l,_ as c,aa as g,ba as w,ca as m,da as f,e as P,ea as x,fa as _,ha as h,jb as I,mb as R,n as C,oa as S,qa as T,s as y,t as b}from"./chunk-ND7GK4P5.mjs";import"./chunk-5XUXGTUW.mjs";var Q=["emptydiv"],V=t=>[t];function D(t,i){t&1&&r(0,"div",1)}function M(t,i){if(t&1&&r(0,"app-postlist",3),t&2){let e=m(2);p("list",e.post.ParentPosts)("showSeperator",!0)}}function k(t,i){if(t&1){let e=g();l(0,"app-textarea",7),w("sendText",function(n){y(e);let O=m(2);return b(O.add(n))}),c()}if(t&2){let e=m(2);p("disablePostButton",e.disablePostButton)}}function F(t,i){t&1&&(l(0,"p",5),h(1,"Login to post"),c())}function N(t,i){t&1&&r(0,"br")(1,"progress",8)}function q(t,i){if(t&1&&(l(0,"div",2),u(1,M,1,2,"app-postlist",3),r(2,"app-postlist",3),l(3,"div",null,0),h(5,"\xA0"),c(),u(6,k,1,1,"app-textarea",4)(7,F,2,0,"p",5)(8,N,2,0),r(9,"app-postlist",6),c()),t&2){let e=m();s(),d(e.post.ParentPosts?1:-1),s(),p("list",T(6,V,e.post))("showSeperator",!1),s(4),d(e._authservice.userdata()?6:7),s(2),d(e.showProgress?8:-1),s(),p("list",e.post.ChildPosts)}}var E=class t{constructor(i,e,o,n){this.route=i;this._postservice=e;this._authservice=o;this.router=n}post;clearTextArea=0;emptydiv;data;disablePostButton=!1;loading=!1;showProgress=!1;textarea;ngOnInit(){this.loading=!0,this.route.params.pipe().subscribe({next:i=>{this.data={username:i.username,id:i.id},this.getPost()}})}getPost(){this._postservice.getPostById(this.data.username,this.data.id,this._authservice.userdata()?.id??null).pipe().subscribe({next:i=>{this.post=i,this.loading=!1},error:i=>{alert(i.error),this.loading=!1}})}add(i){(this._authservice.userdata()?.id??0)!=0&&(this.disablePostButton=!0,this.showProgress=!0,this._postservice.addNewPost({content:i.content,parentpostid:this.post.id,file:i.file}).pipe(P(1e3)).subscribe({next:o=>{this.getPost(),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("success"),this.showProgress=!1,this.textarea.reset()},error:o=>{alert(o.error),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("fail"),this.showProgress=!1}}))}static \u0275fac=function(e){return new(e||t)(a(I),a(B),a(A),a(R))};static \u0275cmp=C({type:t,selectors:[["app-postexpanded"]],viewQuery:function(e,o){if(e&1&&(f(Q,5),f(v,5)),e&2){let n;x(n=_())&&(o.emptydiv=n.first),x(n=_())&&(o.textarea=n.first)}},standalone:!0,features:[S],decls:2,vars:1,consts:[["emptydiv",""],[1,"spinner","center-block"],[1,"container"],[3,"list","showSeperator"],["placeholderText","Post your reply",3,"disablePostButton"],[1,"text-area-p"],[3,"list"],["placeholderText","Post your reply",3,"sendText","disablePostButton"],["aria-busy","true"]],template:function(e,o){e&1&&u(0,D,1,0,"div",1)(1,q,10,8,"div",2),e&2&&d(o.loading?0:o.post?1:-1)},dependencies:[j,v],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:2px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{E as PostexpandedComponent};
