import './polyfills.server.mjs';
import{a as v}from"./chunk-APVAAMLK.mjs";import"./chunk-QWJP5BUG.mjs";import{a as E,b as O}from"./chunk-LCYIUYNC.mjs";import{$ as l,C as g,J as s,L as r,M as w,Q as u,W as p,Y as d,_a as R,aa as c,ba as a,ca as S,da as T,e as C,ea as m,fa as f,ga as x,ha as _,ja as h,nb as j,q as b,qb as A,r as y,ra as I,vb as B}from"./chunk-3GC2ZB3K.mjs";import"./chunk-S6KH3LOX.mjs";var Q=["emptydiv"],D=t=>[t];function M(t,i){t&1&&a(0,"div",1)}function k(t,i){if(t&1&&a(0,"app-postlist",3),t&2){let e=m(2);p("list",e.post.ParentPosts)("showSeperator",!0)}}function F(t,i){if(t&1){let e=S();l(0,"app-textarea",7),T("sendText",function(n){b(e);let P=m(2);return y(P.add(n))}),c()}if(t&2){let e=m(2);p("disablePostButton",e.disablePostButton)}}function N(t,i){t&1&&(l(0,"p",5),h(1,"Login to post"),c())}function q(t,i){t&1&&a(0,"br")(1,"progress",8)}function z(t,i){if(t&1&&(l(0,"div",2),u(1,k,1,2,"app-postlist",3),a(2,"app-postlist",3),l(3,"div",null,0),h(5,"\xA0"),c(),u(6,F,1,1,"app-textarea",4)(7,N,2,0,"p",5)(8,q,2,0),a(9,"app-postlist",6),c()),t&2){let e=m();s(),d(e.post.ParentPosts?1:-1),s(),p("list",I(6,D,e.post))("showSeperator",!1),s(4),d(e._authservice.userdata()?6:7),s(2),d(e.showProgress?8:-1),s(),p("list",e.post.ChildPosts)}}var V=class t{constructor(i,e,o,n,P){this.route=i;this._postservice=e;this._authservice=o;this.router=n;this.platformId=P}post;clearTextArea=0;emptydiv;data;disablePostButton=!1;loading=!1;showProgress=!1;textarea;ngOnInit(){this.loading=!0,this.route.params.pipe().subscribe({next:i=>{this.data={username:i.username,id:i.id},this.getPost()}})}getPost(){this._postservice.getPostById(this.data.username,this.data.id,this._authservice.userdata()?.id??null).pipe().subscribe({next:i=>{this.post=i,R(this.platformId)&&setTimeout(()=>this.emptydiv.nativeElement.scrollIntoView({behavior:"smooth"}),600),this.loading=!1},error:i=>{alert(i.error),this.loading=!1}})}add(i){(this._authservice.userdata()?.id??0)!=0&&(this.disablePostButton=!0,this.showProgress=!0,this._postservice.addNewPost({content:i.content,parentpostid:this.post.id,file:i.file}).pipe(C(1e3)).subscribe({next:o=>{this.getPost(),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("success"),this.showProgress=!1,this.textarea.reset()},error:o=>{alert(o.error),this.disablePostButton=!1,this._postservice.postSuccessSubject.next("fail"),this.showProgress=!1}}))}static \u0275fac=function(e){return new(e||t)(r(j),r(E),r(B),r(A),r(g))};static \u0275cmp=w({type:t,selectors:[["app-postexpanded"]],viewQuery:function(e,o){if(e&1&&(f(Q,5),f(v,5)),e&2){let n;x(n=_())&&(o.emptydiv=n.first),x(n=_())&&(o.textarea=n.first)}},decls:2,vars:1,consts:[["emptydiv",""],[1,"spinner","center-block"],[1,"container"],[3,"list","showSeperator"],["placeholderText","Post your reply",3,"disablePostButton"],[1,"text-area-p"],[3,"list"],["placeholderText","Post your reply",3,"sendText","disablePostButton"],["aria-busy","true"]],template:function(e,o){e&1&&u(0,M,1,0,"div",1)(1,z,10,8,"div",2),e&2&&d(o.loading?0:o.post?1:-1)},dependencies:[O,v],styles:["textarea[_ngcontent-%COMP%]{margin:8px 0;width:100%;font-size:16px;padding:8px;border-radius:8px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;resize:none}"]})};export{V as PostexpandedComponent};
